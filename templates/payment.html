{% extends "base.html" %}
{% block title %}Payments{% endblock %}

{% block content %}
<h2>Payment Simulation</h2>
<div class="card mb-4">
	<div class="card-body">
		<h5 class="card-title">Make a Payment</h5>
		<form method="POST">
			<!-- CSRF Token (MUST be added) -->
			<input type="hidden" name="csrf_token" value="{{ csrf_token }}">

			<div class="mb-3">
				<label for="card_number" class="form-label">Card Number (simulation only)</label>
				<input type="text" class="form-control" id="card_number" name="card_number" pattern="\d{16}"
					maxlength="16" placeholder="Any 16 digits will work" pattern="\d{16}" title="Enter 16 digits">
			</div>
			<div class="mb-3">
				<label for="amount" class="form-label">Amount</label>
				<input type="number" class="form-control" id="amount" name="amount" value="100" min="1" step="0.01"
					required>
			</div>
			<button type="submit" class="btn btn-primary">Process Payment</button>
		</form>
	</div>
</div>

<h2>Transaction History</h2>
{% if history %}
<div class="table-responsive">
	<table class="table">
		<thead class="table-light">
			<tr>
				<th>Date</th>
				<th>Transaction ID</th>
				<th>Amount</th>
				<th>Status</th>
			</tr>
		</thead>
		<tbody>
			{% for payment in history %}
			<tr>
				<td>{{ payment.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
				<td class="font-monospace">{{ payment.transaction_id }}</td>
				<td>${{ "%.2f"|format(payment.amount) }}</td>
				<td><span class="badge bg-success">{{ payment.status }}</span></td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% else %}
<div class="alert alert-info">No transaction history found</div>
{% endif %}
{% endblock %}