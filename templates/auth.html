<!-- templates/auth.html -->
{% extends "base.html" %}
{% block title %}Authentication{% endblock %}

{% block content %}
<div class="row justify-content-center">
	<div class="col-md-6 col-lg-4">

		{% if mode == 'login' %}
		<h2 class="text-center mb-4">Login</h2>
		<form method="post">
			<input type="hidden" name="form_type" value="login">
			<div class="form-floating mb-3">
				<input type="email" class="form-control" id="email" name="email" placeholder="name@example.com"
					required>
				<label for="email">Email address</label>
			</div>
			<div class="form-floating mb-3">
				<input type="password" class="form-control" id="password" name="password" placeholder="Password"
					required>
				<label for="password">Password</label>
			</div>
			<button class="w-100 btn btn-lg btn-primary" type="submit">Sign in</button>
			<p class="mt-3 text-center"><a href="{{ url_for('auth', mode='reset') }}">Forgot password?</a></p>
		</form>

		{% elif mode == 'register' %}
		<h2 class="text-center mb-4">Register</h2>
		<form method="post">
			<input type="hidden" name="form_type" value="register">
			<!-- Age Verification -->
			<div class="mb-3 form-check">
				<input type="checkbox" class="form-check-input" id="age_verify" required>
				<label class="form-check-label" for="age_verify">I confirm I am over 18 years old.</label>
			</div>
			<div class="form-floating mb-3">
				<input type="email" class="form-control" id="email" name="email" placeholder="name@example.com"
					required>
				<label for="email">Email address</label>
			</div>
			<div class="form-floating mb-3">
				<input type="password" class="form-control" id="password" name="password" placeholder="Password"
					required>
				<label for="password">Password</label>
			</div>
			<div class="form-floating mb-3">
				<select class="form-select" id="role" name="role" required>
					<option value="seeker">I am a Seeker</option>
					<option value="escort">I am an Escort</option>
				</select>
				<label for="role">Select your role</label>
			</div>
			<!-- CAPTCHA Simulation -->
			<div class="mb-3 p-3 bg-light text-center border rounded">
				<p class="m-0">[CAPTCHA goes here]</p>
			</div>
			<button class="w-100 btn btn-lg btn-primary" type="submit">Register</button>
		</form>

		{% elif mode == 'reset' and not token %}
		<h2 class="text-center mb-4">Reset Password</h2>
		<p class="text-muted text-center">Enter your email to receive a password reset link.</p>
		<form method="post">
			<input type="hidden" name="form_type" value="reset">
			<div class="form-floating mb-3">
				<input type="email" class="form-control" id="email" name="email" placeholder="name@example.com"
					required>
				<label for="email">Email address</label>
			</div>
			<button class="w-100 btn btn-lg btn-primary" type="submit">Send Reset Link</button>
		</form>

		{% elif mode == 'reset' and token %}
		<h2 class="text-center mb-4">Set New Password</h2>
		<p>Token: {{ token }}</p>
		<!-- New Password Form -->

		{% elif mode == 'verify' %}
		<h2 class="text-center mb-4">Email Verification</h2>
		<div class="alert alert-success">Email with token {{token}} successfully verified! You can now log in.</div>

		{% elif mode == 'locked' %}
		<h2 class="text-center mb-4">Account Locked</h2>
		<div class="alert alert-danger">Your account is currently locked. Please contact support for assistance.</div>

		{% elif mode == 'timeout' %}
		<h2 class="text-center mb-4">Session Expired</h2>
		<div class="alert alert-warning">Your session has expired. Please log in again.</div>

		{% endif %}

		<p class="mt-5 mb-3 text-muted text-center">Â© 2023</p>
	</div>
</div>
{% endblock %}